import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize
from scipy.integrate import quad


def f(r,a):
    return np.sqrt(2/np.pi) * a * np.exp(-a * r)


ds = np.linspace(0.0001,100,1000)
Es = np.zeros(len(ds))

for i,d in enumerate(ds):
    def intf(a):
        fun = lambda x: -x*f(x,a)**2/np.sqrt(x**2 + d**2)
        return a**2/2 + 2*np.pi*quad(fun,0,20)[0]
    
    res = minimize(intf,1)
    
    E0 = res.fun
    ab = res.x
    
    print(E0,ab)
    
    Es[i] = E0

Es = 1/4 * 27.2*Es
#Es = 1/2 * Es

ds = 0.001*52.9 * ds
mathematica3 =  1/4 * 27.2 * np.array([-1.9998, -1.66952, -1.46962, -1.32603, -1.21521, -1.1259, -1.05176, 
-0.98884, -0.934546, -0.887054, -0.845051, -0.807558, -0.773826, 
-0.743271, -0.715431, -0.689931, -0.666466, -0.644785, -0.624678, 
-0.605967, -0.588502, -0.572155, -0.556814, -0.542384, -0.52878, 
-0.515929, -0.503767, -0.492236, -0.481285, -0.47087, -0.460949, 
-0.451487, -0.44245, -0.433808, -0.425536, -0.417608, -0.410003, 
-0.402699, -0.395679, -0.388926, -0.382423, -0.376156, -0.370113,
-0.36428, -0.358647, -0.353202, -0.347937, -0.342842, -0.337907, 
-0.333127, -0.328493, -0.323998, -0.319635, -0.3154, -0.311285, 
-0.307286, -0.303398, -0.299616, -0.295935, -0.292351, -0.288861, -0.28546, -0.282146, -0.278914, -0.275761, -0.272685, -0.269682, \
-0.266751, -0.263887, -0.26109, -0.258356, -0.255683, -0.253069, 
-0.250513, -0.248012, -0.245564, -0.243167, -0.240821, -0.238523, 
-0.236272, -0.234066, -0.231904, -0.229785, -0.227707, -0.225669, 
-0.22367, -0.221708, -0.219783, -0.217894, -0.216039, -0.214218, 
-0.21243, -0.210673, -0.208947, -0.207252, -0.205585, -0.203947, 
-0.202337, -0.200753, -0.199196])
    
mathematica100 = 1/2*27.2 * np.array([-0.999951, -0.765634, -0.644893, -0.564841, -0.506264, -0.460878, 
-0.424346, -0.394118, -0.368578, -0.34664, -0.327542, -0.310729, 
-0.29579, -0.282409, -0.270339, -0.259386, -0.249392, -0.240231, 
-0.231795, -0.223999, -0.216767, -0.210038, -0.203759, -0.197883,
-0.19237, -0.187188, -0.182305, -0.177694, -0.173334, -0.169202, 
-0.165281, -0.161555, -0.158007, -0.154626, -0.1514, -0.148317, -0.145368, -0.142543, -0.139836, -0.137238, -0.134743, -0.132344, \
-0.130035, -0.127813, -0.125671, -0.123605, -0.121611, -0.119686, 
-0.117825, -0.116025, -0.114284, -0.112597, -0.110964, -0.109381, 
-0.107845, -0.106355, -0.104909, -0.103504, -0.102138, -0.100811, 
-0.0995205, -0.0982646, -0.0970421, -0.0958517, -0.094692, -0.093562, 
-0.0924603, -0.091386, -0.0903379, -0.0893152, -0.0883168, 
-0.0873419, -0.0863896, -0.0854592, -0.0845498, -0.0836608,
-0.0827914, -0.081941, -0.081109, -0.0802946, -0.0794975, -0.0787169, 
-0.0779525, -0.0772036, -0.0764698, -0.0757506, -0.0750456, 
-0.0743544, -0.0736765, -0.0730116, -0.0723592, -0.0717191, 
-0.0710908, -0.070474, -0.0698684, -0.0692737, -0.0686896, 
-0.0681159, -0.0675521, -0.0669981, -0.0664536, -0.0659184,-0.0653921, -0.0648747, -0.0643658, -0.0638652, -0.0633728, \
-0.0628883, -0.0624115, -0.0619423, -0.0614805, -0.0610258,
-0.0605782, -0.0601374, -0.0597033, -0.0592758, -0.0588546,
-0.0584397, -0.0580308, -0.057628, -0.0572309, -0.0568396, 
-0.0564538, -0.0560735, -0.0556986, -0.0553289, -0.0549642, 
-0.0546046, -0.0542499, -0.0539, -0.0535547, -0.0532141, -0.052878, 
-0.0525463, -0.052219, -0.0518959, -0.0515769, -0.051262, -0.0509511, 
-0.0506442, -0.0503411, -0.0500417, -0.0497461, -0.0494541, 
-0.0491656, -0.0488807, -0.0485992, -0.048321, -0.0480462, -0.0477746, -0.0475062, -0.0472409, -0.0469787, -0.0467196, \
-0.0464633, -0.0462101, -0.0459596, -0.045712, -0.0454672, 
-0.0452251, -0.0449857, -0.0447489, -0.0445146, -0.044283, 
-0.0440538, -0.0438271, -0.0436028, -0.0433809, -0.0431613,
-0.042944, -0.042729, -0.0425163, -0.0423057, -0.0420973, -0.041891, 
-0.0416868, -0.0414847, -0.0412846, -0.0410865, -0.0408904, 
-0.0406962, -0.040504, -0.0403136, -0.040125, -0.0399383, -0.0397534, 
-0.0395703, -0.0393889, -0.0392092, -0.0390312, -0.0388549, 
-0.0386803, -0.0385072, -0.0383358, -0.038166, -0.0379977, 
-0.0378309, -0.0376657, -0.0375019, -0.0373397, -0.0371788,
-0.0370194, -0.0368615, -0.0367049, -0.0365497, -0.0363958,
-0.0362433, -0.0360921, -0.0359423, -0.0357937, -0.0356463,
-0.0355003, -0.0353554, -0.0352118, -0.0350694, -0.0349282,
-0.0347881, -0.0346492, -0.0345115, -0.0343749, -0.0342394,
-0.034105, -0.0339717, -0.0338395, -0.0337083, -0.0335782, 
-0.0334492, -0.0333211, -0.0331941, -0.033068, -0.032943, -0.0328189, 
-0.0326958, -0.0325737, -0.0324524, -0.0323322, -0.0322128, 
-0.0320944, -0.0319768, -0.0318601, -0.0317443, -0.0316294, 
-0.0315154, -0.0314022, -0.0312898, -0.0311782, -0.0310675, 
-0.0309576, -0.0308485, -0.0307402, -0.0306327, -0.0305259, 
-0.0304199, -0.0303147, -0.0302102, -0.0301065, -0.0300035, 
-0.0299012, -0.0297996, -0.0296988, -0.0295986, -0.0294992, 
-0.0294004, -0.0293024, -0.0292049, -0.0291082, -0.0290121, 
-0.0289167, -0.0288219, -0.0287278, -0.0286343, -0.0285414, -0.0284492, -0.0283575, -0.0282665, -0.0281761, -0.0280862, \
-0.027997, -0.0279083, -0.0278202, -0.0277327, -0.0276458, 
-0.0275594, -0.0274736, -0.0273883, -0.0273036, -0.0272194,
-0.0271357, -0.0270526, -0.02697, -0.0268879, -0.0268063, -0.0267253, 
-0.0266447, -0.0265646, -0.0264851, -0.026406, -0.0263274, 
-0.0262493, -0.0261717, -0.0260945, -0.0260178, -0.0259416,
-0.0258658, -0.0257905, -0.0257157, -0.0256412, -0.0255673,
-0.0254937, -0.0254206, -0.025348, -0.0252757, -0.0252039, 
-0.0251325, -0.0250616, -0.024991, -0.0249208, -0.0248511, 
-0.0247817, -0.0247128, -0.0246442, -0.024576, -0.0245082, 
-0.0244408, -0.0243738, -0.0243072, -0.0242409, -0.024175, 
-0.0241095, -0.0240443, -0.0239795, -0.0239151, -0.023851, 
-0.0237873, -0.0237239, -0.0236609, -0.0235982, -0.0235358, 
-0.0234738, -0.0234121, -0.0233508, -0.0232898, -0.0232291, 
-0.0231687, -0.0231087, -0.023049, -0.0229896, -0.0229305, 
-0.0228717, -0.0228132, -0.0227551, -0.0226972, -0.0226397, 
-0.0225824, -0.0225255, -0.0224688, -0.0224124, -0.0223564, 
-0.0223006, -0.0222451, -0.0221898, -0.0221349, -0.0220802, 
-0.0220259, -0.0219718, -0.0219179, -0.0218644, -0.0218111, 
-0.021758, -0.0217053, -0.0216528, -0.0216005, -0.0215486, 
-0.0214968, -0.0214454, -0.0213942, -0.0213432, -0.0212925, 
-0.021242, -0.0211918, -0.0211418, -0.0210921, -0.0210426,
-0.0209934, -0.0209443, -0.0208956, -0.020847, -0.0207987, 
-0.0207506, -0.0207028, -0.0206551, -0.0206077, -0.0205605, 
-0.0205136, -0.0204669, -0.0204203, -0.020374, -0.020328, -0.0202821, 
-0.0202364, -0.020191, -0.0201458, -0.0201007, -0.0200559, 
-0.0200113, -0.0199669, -0.0199227, -0.0198787, -0.0198349, 
-0.0197913, -0.0197479, -0.0197047, -0.0196617, -0.0196188, 
-0.0195762, -0.0195338, -0.0194915, -0.0194495, -0.0194076, 
-0.0193659, -0.0193244, -0.0192831, -0.019242, -0.019201, -0.0191602, 
-0.0191197, -0.0190792, -0.019039, -0.0189989, -0.0189591, 
-0.0189193, -0.0188798, -0.0188404, -0.0188012, -0.0187622, 
-0.0187233, -0.0186846, -0.0186461, -0.0186077, -0.0185695, 
-0.0185315, -0.0184936, -0.0184559, -0.0184183, -0.0183809, 
-0.0183437, -0.0183066, -0.0182696, -0.0182329, -0.0181962, 
-0.0181598, -0.0181234, -0.0180873, -0.0180512, -0.0180154, 
-0.0179796, -0.017944, -0.0179086, -0.0178733, -0.0178382, 
-0.0178031, -0.0177683, -0.0177336, -0.017699, -0.0176645, 
-0.0176302, -0.017596, -0.017562, -0.0175281, -0.0174943, -0.0174607, 
-0.0174272, -0.0173938, -0.0173606, -0.0173274, -0.0172945, 
-0.0172616, -0.0172289, -0.0171963, -0.0171638, -0.0171314, 
-0.0170992, -0.0170671, -0.0170351, -0.0170032, -0.0169714, 
-0.0169398, -0.0169083, -0.0168769, -0.0168456, -0.0168144, 
-0.0167833, -0.0167524, -0.0167216, -0.0166908, -0.0166602, 
-0.0166297, -0.0165993, -0.016569, -0.0165388, -0.0165088, 
-0.0164788, -0.0164489, -0.0164192, -0.0163895, -0.0163599,
-0.0163305, -0.0163011, -0.0162719, -0.0162427, -0.0162137,
-0.0161847, -0.0161559, -0.0161271, -0.0160984, -0.0160699,
-0.0160414, -0.016013, -0.0159847, -0.0159566, -0.0159285, 
-0.0159005, -0.0158726, -0.0158448, -0.015817, -0.0157894, 
-0.0157619, -0.0157344, -0.0157071, -0.0156798, -0.0156526,
-0.0156256, -0.0155986, -0.0155717, -0.0155449, -0.0155181,
-0.0154915, -0.015465, -0.0154385, -0.0154121, -0.0153859, 
-0.0153597, -0.0153336, -0.0153075, -0.0152816, -0.0152558, -0.01523, 
-0.0152043, -0.0151787, -0.0151533, -0.0151278, -0.0151025, 
-0.0150773, -0.0150521, -0.015027, -0.015002, -0.0149771, -0.0149523, 
-0.0149276, -0.0149029, -0.0148784, -0.0148539, -0.0148295,
-0.0148051, -0.0147809, -0.0147567, -0.0147326, -0.0147086,
-0.0146847, -0.0146609, -0.0146371, -0.0146134, -0.0145898,
-0.0145663, -0.0145428, -0.0145195, -0.0144962, -0.0144729,
-0.0144498, -0.0144267, -0.0144037, -0.0143808, -0.014358, 
-0.0143352, -0.0143125, -0.0142899, -0.0142674, -0.0142449,
-0.0142225, -0.0142002, -0.0141779, -0.0141557, -0.0141336,
-0.0141116, -0.0140896, -0.0140677, -0.0140459, -0.0140242,
-0.0140025, -0.0139808, -0.0139593, -0.0139378, -0.0139164,
-0.013895, -0.0138738, -0.0138526, -0.0138314, -0.0138103, 
-0.0137893, -0.0137684, -0.0137475, -0.0137267, -0.0137059, 
-0.0136852, -0.0136646, -0.013644, -0.0136235, -0.0136031,
-0.0135827, -0.0135624, -0.0135422, -0.013522, -0.0135019,
-0.0134818, -0.0134618, -0.0134419, -0.013422, -0.0134022,
-0.0133824, -0.0133627, -0.0133431, -0.0133235, -0.013304, 
-0.0132845, -0.0132651, -0.0132457, -0.0132264, -0.0132072, 
-0.013188, -0.0131689, -0.0131498, -0.0131308, -0.0131119, -0.013093, 
-0.0130742, -0.0130554, -0.0130366, -0.013018, -0.0129993,
-0.0129808, -0.0129623, -0.0129438, -0.0129254, -0.012907, 
-0.0128887, -0.0128705, -0.0128523, -0.0128342, -0.0128161, 
-0.012798, -0.01278, -0.0127621, -0.0127442, -0.0127264, -0.0127086, 
-0.0126909, -0.0126732, -0.0126556, -0.012638, -0.0126204, -0.012603, 
-0.0125855, -0.0125681, -0.0125508, -0.0125335, -0.0125163, 
-0.0124991, -0.0124819, -0.0124648, -0.0124478, -0.0124308, 
-0.0124138, -0.0123969, -0.0123801, -0.0123632, -0.0123465, 
-0.0123297, -0.0123131, -0.0122964, -0.0122798, -0.0122633,
-0.0122468, -0.0122304, -0.0122139, -0.0121976, -0.0121813,
-0.012165, -0.0121487, -0.0121326, -0.0121164, -0.0121003, 
-0.0120843, -0.0120682, -0.0120523, -0.0120363, -0.0120204, 
-0.0120046, -0.0119888, -0.011973, -0.0119573, -0.0119416, -0.011926, -0.0119104, -0.0118948, -0.0118793, -0.0118638, -0.0118484, 
-0.011833, -0.0118176, -0.0118023, -0.011787, -0.0117718, -0.0117566, 
-0.0117414, -0.0117263, -0.0117112, -0.0116962, -0.0116812,
-0.0116662, -0.0116513, -0.0116364, -0.0116215, -0.0116067,
-0.0115919, -0.0115772, -0.0115625, -0.0115478, -0.0115332,
-0.0115186, -0.0115041, -0.0114895, -0.011475, -0.0114606, 
-0.0114462, -0.0114318, -0.0114175, -0.0114032, -0.0113889, 
-0.0113747, -0.0113605, -0.0113463, -0.0113322, -0.0113181, 
-0.011304, -0.01129, -0.011276, -0.011262, -0.0112481, -0.0112342, 
-0.0112203, -0.0112065, -0.0111927, -0.011179, -0.0111652, 
-0.0111515, -0.0111379, -0.0111242, -0.0111107, -0.0110971, 
-0.0110836, -0.0110701, -0.0110566, -0.0110432, -0.0110297,
-0.0110164, -0.011003, -0.0109897, -0.0109764, -0.0109632, -0.01095, 
-0.0109368, -0.0109236, -0.0109105, -0.0108974, -0.0108843, 
-0.0108713, -0.0108583, -0.0108453, -0.0108324, -0.0108195, 
-0.0108066, -0.0107937, -0.0107809, -0.0107681, -0.0107553, 
-0.0107426, -0.0107299, -0.0107172, -0.0107045, -0.0106919, 
-0.0106793, -0.0106667, -0.0106542, -0.0106417, -0.0106292, 
-0.0106167, -0.0106043, -0.0105919, -0.0105795, -0.0105671, 
-0.0105548, -0.0105425, -0.0105303, -0.010518, -0.0105058, 
-0.0104936, -0.0104814, -0.0104693, -0.0104572, -0.0104451, 
-0.010433, -0.010421, -0.010409, -0.010397, -0.0103851, -0.0103731, 
-0.0103612, -0.0103493, -0.0103375, -0.0103257, -0.0103139, 
-0.0103021, -0.0102903, -0.0102786, -0.0102669, -0.0102552, 
-0.0102435, -0.0102319, -0.0102203, -0.0102087, -0.0101971, 
-0.0101856, -0.0101741, -0.0101626, -0.0101511, -0.0101397, 
-0.0101283, -0.0101169, -0.0101055, -0.0100941, -0.0100828, 
-0.0100715, -0.0100602, -0.010049, -0.0100377, -0.0100265, -0.0100153, -0.0100042, -0.00999301, -0.00998189, -0.00997079, 
-0.0099597, -0.00994865, -0.00993761, -0.00992659, -0.0099156, 
-0.00990463, -0.00989367, -0.00988275, -0.00987184, -0.00986095, 
-0.00985008, -0.00983924, -0.00982841, -0.00981761, -0.00980683, 
-0.00979607, -0.00978533, -0.00977461, -0.00976391, -0.00975323, 
-0.00974257, -0.00973193, -0.00972131, -0.00971071, -0.00970013, 
-0.00968958, -0.00967904, -0.00966852, -0.00965802, -0.00964754, 
-0.00963708, -0.00962664, -0.00961622, -0.00960582, -0.00959543, 
-0.00958507, -0.00957473, -0.0095644, -0.0095541, -0.00954381, 
    -0.00953354, -0.00952329, -0.00951306, -0.00950285, -0.00949265, 
-0.00948248, -0.00947232, -0.00946218, -0.00945206, -0.00944196, 
-0.00943188, -0.00942181, -0.00941176, -0.00940173, -0.00939172, 
-0.00938173, -0.00937175, -0.00936179, -0.00935185, -0.00934193, 
-0.00933202, -0.00932213, -0.00931226, -0.00930241, -0.00929257, 
-0.00928275, -0.00927295, -0.00926316, -0.0092534, -0.00924364, 
-0.00923391, -0.00922419, -0.00921449, -0.00920481, -0.00919514, 
-0.00918549, -0.00917586, -0.00916624, -0.00915664, -0.00914705, 
-0.00913748, -0.00912793, -0.00911839, -0.00910887, -0.00909937, 
-0.00908988, -0.00908041, -0.00907095, -0.00906151, -0.00905209, 
-0.00904268, -0.00903329, -0.00902391, -0.00901455, -0.0090052, 
-0.00899587, -0.00898655, -0.00897725, -0.00896797, -0.0089587, 
-0.00894945, -0.00894021, -0.00893098, -0.00892178, -0.00891258, 
-0.0089034, -0.00889424, -0.00888509, -0.00887596, -0.00886684, 
-0.00885773, -0.00884864, -0.00883957, -0.00883051, -0.00882146, 
-0.00881243, -0.00880342, -0.00879441, -0.00878543, -0.00877645, 
-0.00876749, -0.00875855, -0.00874962, -0.0087407, -0.0087318, 
-0.00872291, -0.00871404, -0.00870518, -0.00869633, -0.0086875, 
-0.00867868, -0.00866987, -0.00866108, -0.00865231, -0.00864354,
-0.00863479, -0.00862606, -0.00861733, -0.00860862])

    
plt.figure(dpi=300)
plt.xlabel("$d$ [nm]")
plt.ylabel("$E_0$ [eV]")
#plt.plot(ds,mathematica,color="blue",label="Numerical Solution")
plt.plot(ds,Es,color="red",label ="Variational Solution")
plt.plot(ds,mathematica100,color="blue",label="Numerical Solution")

plt.grid(True)
plt.legend()
plt.show()